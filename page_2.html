<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=640,user-scalable=no">
    <meta name="format-detection" content="telephone=no"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>你是否记得，十年前的自己</title>
    <link rel="stylesheet" type="text/css" href="./main.css">
    <script src="./js/wxmoment.min.js"></script>
  </head>
  <body>
    <!-- 加载 -->
    <div class="loading">
      <img class="lock" src="./images/6aJ7IGCWN.png" />
      <svg fill="0" class="small" stroke="#BA7676" stroke-width="2.5"><line x1="15" y1="10" x2="70" y2="10"></line></svg>
      <svg fill="0" class="big" stroke="#784C4C" stroke-width="2.5"><line x1="15" y1="10" x2="50" y2="10"></line></svg>
      <div class="redio"></div>
      <img src="./images/FtvJHVam.jpg" class="banner" />
      <div class="gress">
        <img src="./images/gress.jpg" />
        <div class="text">0%</div>
      </div>
    </div>
    <div class="page_all">
      <div class="wrap">
        <section class="screen screen2" data-lock-prev="true" data-lock-next="true">
          <img src="./images/vd8JL8FB.jpg" class="bg">
          <img src="./images/qcZG7NG3.jpg" class="btm no_opc" />
          <img src="./images/alogo.png" class="logo no_opc" />
          <img src="./images/year.png" class="year" />
          <img src="./images/22wa.png" class="year_txt" />
          <img src="./images/anmat_5.png" class="animation_1 an_6" />
          <img src="./images/anmat_2.png" class="animation_2" />
          <img src="./images/anmat_3.png" class="animation_3" />
          <img src="./images/anmat_4.png" class="animation_4" />
          <img src="./images/anmat_5.png" class="animation_5" />
          <img src="./images/swipe.png" class="swipe" />
        </section>
      </div>
    </div>
    <script src="./js/jweixin-1.0.0.js"></script>
    <script type="text/javascript">
      $(document).ready(function(){
        // 放大元素,按照320x504定位,按比例scale
        function scaleEle(selector,position){
          var screenHeight = document.documentElement.clientHeight/2,
            screenWidth = document.documentElement.clientWidth/2;
          var pageScale;
          var currentScale=screenWidth/screenHeight;
          var originScale=320/504;
          if(currentScale>originScale){
            pageScale=screenHeight/504;
          }else{
            pageScale=screenWidth/320;
          }
          if(/Safari/i.test(navigator.userAgent)) {
            pageScale = 1
          }
          $(selector).css({"-webkit-transform-origin":position,"transform-origin":position,"-webkit-transform":"scale("+pageScale+");","transform":"Scale("+pageScale+");","transform":"scale("+pageScale+")"});
        }
        if(/Safari/i.test(navigator.userAgent)) {
          $('.screen.screen5').css('overflow','scroll');
          $('.screen.screen5 .submit').css('top','900px')
          scaleEle(".page_all","bottom","center");
        }else{
          scaleEle(".page_all","center");
        }

        /**
          * 微信浏览器加载音乐
         */
        function is_weixn(){ 
          var ua = navigator.userAgent.toLowerCase(); 
          if(ua.match(/MicroMessenger/i)=="micromessenger") { 
            return true; 
          } else { 
            return false; 
          } 
        } 
        if( is_weixn() ){
          document.addEventListener("WeixinJSBridgeReady", function () {
            var audio = new Audio();
            audio.src = "./music.mp3",
            audio.loop = true,
            audio.play();
          }, false);
        }else{
          var audio = new Audio();
          audio.src = "./music.mp3",
          audio.loop = true,
          audio.play();
        }
        // 是否PC 打开
        function is_pc(){
          if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
            return false
          } else {
            return true
          }
        }
        function is_huawei(){
          if(/HUAWEI/i.test(navigator.userAgent)) {
            $('body').css('width','100%');
            $('.page_all').css({"-webkit-transform-origin":"bottom","transform-origin":"bottom","-webkit-transform":"scale(1);","transform":"scale(1);","transform":"scale(1)"});
            $('.content').css({'top':'100px','width':'400px','height':'694px','left':'120px'})
            $('.submit').css('top','820px');
            $('.name').css('top','373px');
            $('.phone').css('top','503px');
            $('select').css({'width':'400px','padding-left':'188px','left':'104px','top':'438px'});
            $('.number').css('top','570px');
            $('.checkNum').css({'top':'570px','left':'380px'});
            $('.code').css('top','635px');
            $('.weui-cell__ft').css({'top':'635px','left':'320px'});
            $('.tab1').css({'top': '700px','left': '112px'})
            $('.tab_1').css({'top': '704px','left': '118px'})
            $('.tab2').css({'top': '742px','left': '112px'})
            $('.tab_2').css({'top': '744px','left': '118px'})
            $('.view_show.tap').css({'top':'706px','left':'152px'})
            $('.small,.big,.redio').css('top','29.5%');
            $('.screen3 .year').css('top','300px');
            $('.screen3 .animation_text').css('top','486px');
            $('.animation_pto').css('top','608px');
            $('.screen4 .bg').css('height','100%');
            $('.screen4 .animation_text').css('top','335px')
          } else {
            return false
          }
        }
        is_huawei()
        /** 
         *  加载
        **/
        function timedCount(num){
          num++;
          percent = num;
          $('.gress img').css('width',percent+'%'); // 加载跳
          $('.text').text(percent + '%');
          
          // 设置条件使停止计时
          if (num<100) {
              var t = setTimeout(function(){timedCount(num)},30); // 30  百分比时间
          }else{
            $('.loading').remove();
            $('.wrap').show(500).css('height',$('body').height());
            $('.screen').addClass('current');
            $('.sc_1').css({'left':'0','transition':'left 0.5s'});
            $('.logo').css({'left':'42px','transition':'left 0.5s'})
            $('.sc_btm').css({'opacity':'1','transition':'opacity 2s'})
          }
        }
        timedCount(0)
        $('.small').addClass('rota');
        $('.big').addClass('rotaa');
        var tab1 = false; // check默认未选中
        var tab2 = false; // check默认未选中

        // 横屏提示
        //new WxMoment.OrientationTip();
        var pageSlider = new WxMoment.PageSlider({
          pages: $('.screen'),            //必需，需要切换的所有屏
          direction: 'vertical',          //可选，vertical 或 v 为上下滑动，horizontal 或 h 为左右滑动，默认为 vertical
          currentClass: 'current',        //可选，当前屏的class (方便实现内容的进场动画)，默认值为 'current'
          rememberLastVisited: false,      //可选，记住上一次访问结束后的索引值，可用于实现页面返回后是否回到上次访问的页面
          animationPlayOnce: false,       //可选，切换页面时，动画只执行一次
          oninit: function () {
            // if(this.lastVisitedIndex){
            //   //如果返回是true，就执行下面跳转代码
            //   this.moveTo(this.lastVisitedIndex, true);
            // }
          },         //可选，初始化完成时的回调
          onbeforechange: function () {}, //可选，开始切换前的回调
          onchange: function () {},       //可选，每一屏切换完成时的回调
          onSwipeUp: function () {},      //可选，swipeUp 回调
          onSwipeDown: function () {},    //可选，swipeDown 回调
          onSwipeLeft: function () {},    //可选，swipeLeft 回调
          onSwipeRight: function () {}    //可选，swipeRight 回调
        });
        if( !is_pc() ){
          console.log('手机')
          function swipePage(num){
            $('.screen'+num).swipeUp(function(){
              pageSlider.moveTo(num, true)
            })
            $('.screen'+num).swipeDown(function(){
              pageSlider.moveTo(num - 2, true)
            })
          }
        }else{
          console.log('PC');
          $('.screen.screen5').css('overflow','scroll'); // PC 提交页超出可滑动
          $('.page_all').css({"-webkit-transform-origin":top,"transform-origin":top,"-webkit-transform":"scale(1);","transform":"Scale(1);","transform":"scale(1)"});
          function swipePage(num){
            $('.screen'+num).click(function(){
              pageSlider.moveTo(num, true)
            })
          }
        }
        
        
        $('.screen4 .btm,.apply').click(function(){
          pageSlider.moveTo(4, true)
        })
        $('.view_show').click(function(){
          $('.model').show(300)
        })
        $('.close').click(function(){
          $('.model').hide(300)
        })
        // 点击获取验证码
        $('.weui-cell__ft').click(function(){
          var phone = $('.phone').val();
          var status = $('.weui-cell__ft').data('disabled');
          if( !status ){
            if(!(/^1[3|4|5|7|8][0-9]\d{8}$/i.test(phone))){
              alert('请输入正确的手机号码', 3000);
            }else{
              // 获取验证码
              getTime(30,'.weui-cell__ft');
            }
          }
        })

        $('.tab1').click(function(){
          $('.tab_1').css('visibility','visible');
          tab1 = true;
        })
        $('.tab2').click(function(){
          $('.tab_2').css('visibility','visible');
          tab2 = true;
        })
        $('.tab_1').click(function(){
          $(this).css('visibility','hidden')
        })
        $('.tab_2').click(function(){
          $(this).css('visibility','hidden')
        })
        // 选中城市
        var city = $("select").val();
        $('select').change(function(){
          city = $(this).val()
        })
        $('select').change(function(){
          console.log($(this).val())
        })
        // 提交
        $('.submit').click(function(){
          var name = $('.name').val();
          var phone = $('.phone').val();
          var number = $('.number').val();
          var code = $('.code').val();
          if( name == '' || phone == '' || city == '' || number == '' || code == '' || !tab1 || !tab2){
            alert('填写信息有误，请重新输入')
          }else{
            alert('提交表单')
          }
        })
      })
      // 该手机号已领取
      $('.hasmodel').show(300);
      // 关闭提示
      $('.hasmodel').click(function(){
        $(this).hide();
      })

      // 获取验证码 倒计时
      function getTime(currentTime,idname){
        this.currentTime = parseInt(currentTime);
        this.idname = idname;
        $(idname).addClass('weui-btn_plain-disabled').data('disabled',true);
        var interval=setInterval(function(){ 
          currentTime--;
          var Time = currentTime+('秒重新发送');
          $(idname).find('button').text(Time);
          if(currentTime<=0){
            clearInterval(interval);
            var Time = '获取验证码';
            $(idname).removeClass('weui-btn_plain-disabled').data('disabled',false).find('button').text(Time);
          }
        },1000)
      }
      
      $(function(){
        wx.config({
          debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
          appId: '${jsapi_appid!}', // 必填，公众号的唯一标识
          timestamp:'${jsapi_timestamp!}' , // 必填，生成签名的时间戳
          nonceStr: '${jsapi_nonceStr!}', // 必填，生成签名的随机串
          signature: '${jsapi_signature!}',// 必填，签名，见附录1
          jsApiList: [
              'checkJsApi',  
             'onMenuShareTimeline', //分享给好友
                'onMenuShareAppMessage' //分享到朋友圈'
          ]
        });
        var title = '';
        var desc = '';
        var link = location.href;
        var imgUrl = '';
        //alert(JSON.stringify(sign));
        wx.ready(function(){
          // 2.1 监听“分享给朋友”，按钮点击、自定义分享内容及分享结果接口
          wx.onMenuShareAppMessage({
            title: title,
            desc: desc,
            link: link,
            imgUrl: imgUrl,
          });      

          // 2.2 监听“分享到朋友圈”按钮点击、自定义分享内容及分享结果接口
          wx.onMenuShareTimeline({
            title: title,
            desc: desc,
            link: link,
            imgUrl: imgUrl,
          });

          wx.error(function(res){
              // config信息验证失败会执行error函数，如签名过期导致验证失败，具体错误信息可以打开config的debug模式查看，也可以在返回的res参数中查看，对于SPA可以在这里更新签名。
              //alert("errorMSG:"+res);
          });
        })
      })
      
    </script>
  </body>

</html>