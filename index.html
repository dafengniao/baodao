<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=640,user-scalable=no">
    <meta name="format-detection" content="telephone=no"/>
    <title>你是否记得，十年前的自己</title>
    <link rel="stylesheet" type="text/css" href="./main.css">
    <script src="//wximg.qq.com/wxp/libs/wxmoment/0.0.4/wxmoment.min.js"></script>
    <script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
  </head>

  <body>
    <!-- 加载 -->
    <div class="loading">
      <img class="lock" src="./images/6aJ7IGCWN.png" />
      <svg fill="0" class="small" stroke="#BA7676" stroke-width="2.5"><line x1="15" y1="10" x2="70" y2="10"></line></svg>
      <svg fill="0" class="big" stroke="#784C4C" stroke-width="2.5"><line x1="15" y1="10" x2="50" y2="10"></line></svg>
      <div class="redio"></div>
      <img src="./images/FtvJHVam.jpg" class="banner" />
      <div class="gress">
        <img src="./images/gress.jpg" />
        <div class="text">0%</div>
      </div>
    </div>
    <div class="page_all">
      <div class="wrap">
        <section class="screen screen1" data-lock-next="true">
          <img src="./images/UGKDMGre.jpg" class="bg sc_1" />
          <img src="./images/qcZG7NG3.jpg" class="btm sc_btm" />
          <img src="./images/alogo.png" class="logo" />
          <img src="./images/year.png" class="year" />
          <img src="./images/2wa.png" class="year_txt" />
          <img src="./images/aM946tl4.png" class="animation_1" />
          <img src="./images/anmat_2.png" class="animation_2" />
          <img src="./images/anmat_3.png" class="animation_3" />
          <img src="./images/anmat_4.png" class="animation_4" />
          <img src="./images/anmat_5.png" class="animation_5" />
          <img src="./images/swipe.png" class="swipe" />
        </section>
        <section class="screen screen2" data-lock-prev="true" data-lock-next="true">
          <img src="./images/vd8JL8FB.jpg" class="bg">
          <img src="./images/qcZG7NG3.jpg" class="btm no_opc" />
          <img src="./images/alogo.png" class="logo no_opc" />
          <img src="./images/year.png" class="year" />
          <img src="./images/22wa.png" class="year_txt" />
          <img src="./images/anmat_5.png" class="animation_1 an_6" />
          <img src="./images/anmat_2.png" class="animation_2" />
          <img src="./images/anmat_3.png" class="animation_3" />
          <img src="./images/anmat_4.png" class="animation_4" />
          <img src="./images/anmat_5.png" class="animation_5" />
          <img src="./images/swipe.png" class="swipe" />
        </section>
        <section class="screen screen3" data-lock-prev="true" data-lock-next="true">
          <img src="./images/Fhb1doY5.jpg" class="bg">
          <img src="./images/qcZG7NG3.jpg" class="btm no_opc" />
          <img src="./images/alogo.png" class="logo no_opc" />
          <img src="./images/year.png" class="year" />
          <img src="./images/anmat_5.png" class="animation_1 an_6" />
          <img src="./images/anmat_3.png" class="animation_3 an_6" />
          <img src="./images/anmat_4.png" class="animation_4" />
          <img src="./images/uFayM0Yl.png" class="animation_text" />
          <img src="./images/FHswC1Gl.png" class="animation_pto" />
          <img src="./images/swipe.png" class="swipe" />
        </section>
        <section class="screen screen4" data-lock-prev="true" data-lock-next="true">
          <img src="./images/rJG56fDi.jpg" class="bg">
          <img src="./images/TXSoJjOc.jpg" class="btm no_opc" />
          <img src="./images/anmat_6.png" class="animation_text" />
          <img src="./images/logo.png" class="logo no_opc last" />
          <img src="./images/apply.png" class="apply" />
        </section>
        <section class="screen screen5" data-lock-prev="true">
          <img src="./images/nc8gETmG.jpg" class="bg" />
          <img src="./images/baodao.jpg" class="baodao" />
          <img src="./images/logo.png" class="logo no_opc last" />
          <div class="view_show"></div> <!-- 详情 -->
          <div class="view_show tap"></div>
          <!-- 详情model -->
          <img src="./images/WechatIMG258.jpeg" class="model" />
          <div class="close"></div>
          <img src="./images/KhUaytVd.png" class="content" />
          <input class="name" placeholder="姓名" />
          <input class="phone" placeholder="手机号" />
          <select>
            <option value="北京">北京</option>
            <option value="成都">成都</option>
            <option value="大连">大连</option>
            <option value="广州">广州</option>
            <option value="哈尔滨">哈尔滨</option>
            <option value="杭州">杭州</option>
            <option value="南京">南京</option>
            <option value="宁波">宁波</option>
            <option value="武汉">武汉</option>
            <option value="郑州">郑州</option>
            <option value="重庆">重庆</option>
          </select>
          <input class="number" placeholder="请输入右侧验证码" />
          <div class="checkNum">
            随机验证码
          </div>
          <input class="code" placeholder="请输入验证码" />
          <div class="weui-cell__ft" data-disabled="false" data-count="0">
            <button class="getPhone">获取手机验证码</button>
          </div>
          <div class="tab1" data-tap="false"></div>
          <img class="tab_1" src="./images/check.png" />
          <div class="tab2" data-tap="false"></div>
          <img class="tab_2" src="./images/check.png" />
          <img class="submit" src="./images/submit.png" />
        </section>
      </div>
    </div>
    <script type="text/javascript">
      $(document).ready(function(){
        // 放大元素,按照320x504定位,按比例scale
        function scaleEle(selector,position){
          var screenHeight = document.documentElement.clientHeight/2,
            screenWidth = document.documentElement.clientWidth/2;
          var pageScale;
          var currentScale=screenWidth/screenHeight;
          var originScale=320/504;
          if(currentScale>originScale){
            pageScale=screenHeight/504;
          }else{
            pageScale=screenWidth/320;
          }
          $(selector).css({"-webkit-transform-origin":position,"transform-origin":position,"-webkit-transform":"scale("+pageScale+");","transform":"Scale("+pageScale+");","transform":"scale("+pageScale+")"});
        }
        scaleEle(".page_all","center");

        /**
          * 微信浏览器加载音乐
         */
        document.addEventListener("WeixinJSBridgeReady", function () {
          var audio = new Audio();
          audio.src = "./music.mp3",
          audio.loop = true,
          audio.play();
        }, false);
        /** 
         *  加载
        **/
        function timedCount(num){
          num++;
          percent = num;
          $('.gress img').css('width',percent+'%'); // 加载跳
          $('.text').text(percent + '%');
          
          // 设置条件使停止计时
          if (num<100) {
              var t = setTimeout(function(){timedCount(num)},30); // 30  百分比时间
          }else{
            $('.loading').remove();
            $('.wrap').show(500);
            $('.sc_1').css({'left':'0','transition':'left 0.5s'});
            $('.logo').css({'left':'42px','transition':'left 0.5s'})
            $('.sc_btm').css({'opacity':'1','transition':'opacity 2s'})
          }
        }
        timedCount(0)
        $('.small').addClass('rota');
        $('.big').addClass('rotaa');
        var tab1 = false; // check默认未选中
        var tab2 = false; // check默认未选中

        // 横屏提示
        new WxMoment.OrientationTip();
        var pageSlider = new WxMoment.PageSlider({
          pages: $('.screen'),            //必需，需要切换的所有屏
          direction: 'vertical',          //可选，vertical 或 v 为上下滑动，horizontal 或 h 为左右滑动，默认为 vertical
          currentClass: 'current',        //可选，当前屏的class (方便实现内容的进场动画)，默认值为 'current'
          rememberLastVisited: true,      //可选，记住上一次访问结束后的索引值，可用于实现页面返回后是否回到上次访问的页面
          animationPlayOnce: false,       //可选，切换页面时，动画只执行一次
          oninit: function () {
            // if(this.lastVisitedIndex){
            //   //如果返回是true，就执行下面跳转代码
            //   this.moveTo(this.lastVisitedIndex, true);
            // }
          },         //可选，初始化完成时的回调
          onbeforechange: function () {}, //可选，开始切换前的回调
          onchange: function () {},       //可选，每一屏切换完成时的回调
          onSwipeUp: function () {},      //可选，swipeUp 回调
          onSwipeDown: function () {},    //可选，swipeDown 回调
          onSwipeLeft: function () {},    //可选，swipeLeft 回调
          onSwipeRight: function () {}    //可选，swipeRight 回调
        });
        function swipePage(num){
          $('.screen'+num).swipeUp(function(){
            pageSlider.moveTo(num, true)
          })
          $('.screen'+num).swipeDown(function(){
            pageSlider.moveTo(num - 2, true)
          })
        }
        swipePage(1);
        swipePage(2);
        swipePage(3);
        swipePage(4);
        $('.screen4 .btm,.apply').tap(function(){
          pageSlider.moveTo(4, true)
        })
        $('.view_show').tap(function(){
          $('.model').show(300)
        })
        $('.close').tap(function(){
          $('.model').hide(300)
        })
        // 点击获取验证码
        $('.weui-cell__ft').tap(function(){
          var phone = $('.phone').val();
          var status = $('.weui-cell__ft').data('disabled');
          if( !status ){
            if(!(/^1[3|4|5|7|8][0-9]\d{8}$/i.test(phone))){
              alert('请输入正确的手机号码', 3000);
            }else{
              // 获取验证码
              getTime(30,'.weui-cell__ft');
            }
          }
        })

        $('.tab1').click(function(){
          $('.tab_1').css('visibility','visible');
          tab1 = true;
        })
        $('.tab2').click(function(){
          $('.tab_2').css('visibility','visible');
          tab2 = true;
        })
        $('.tab_1').click(function(){
          $(this).css('visibility','hidden')
        })
        $('.tab_2').click(function(){
          $(this).css('visibility','hidden')
        })
        // 选中城市
        var city = $("select").val();
        $('select').change(function(){
          city = $(this).val()
        })
        $('select').change(function(){
          console.log($(this).val())
        })
        // 提交
        $('.submit').click(function(){
          var name = $('.name').val();
          var phone = $('.phone').val();
          var number = $('.number').val();
          var code = $('.code').val();
          if( name == '' || phone == '' || city == '' || number == '' || code == '' || !tab1 || !tab2){
            alert('填写信息有误，请重新输入')
          }else{
            alert('提交表单')
          }
        })
      })
      // 获取验证码 倒计时
      function getTime(currentTime,idname){
        this.currentTime = parseInt(currentTime);
        this.idname = idname;
        $(idname).addClass('weui-btn_plain-disabled').data('disabled',true);
        var interval=setInterval(function(){ 
          currentTime--;
          var Time = currentTime+('秒重新发送');
          $(idname).find('button').text(Time);
          if(currentTime<=0){
            clearInterval(interval);
            var Time = '获取验证码';
            $(idname).removeClass('weui-btn_plain-disabled').data('disabled',false).find('button').text(Time);
          }
        },1000)
      }
      
      $(function(){
        wx.config({
          debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
          appId: '${jsapi_appid!}', // 必填，公众号的唯一标识
          timestamp:'${jsapi_timestamp!}' , // 必填，生成签名的时间戳
          nonceStr: '${jsapi_nonceStr!}', // 必填，生成签名的随机串
          signature: '${jsapi_signature!}',// 必填，签名，见附录1
          jsApiList: [
              'checkJsApi',  
             'onMenuShareTimeline', //分享给好友
                'onMenuShareAppMessage' //分享到朋友圈'
          ]
        });
        var title = '';
        var desc = '';
        var link = location.href;
        var imgUrl = '';
        //alert(JSON.stringify(sign));
        wx.ready(function(){
          // 2.1 监听“分享给朋友”，按钮点击、自定义分享内容及分享结果接口
          wx.onMenuShareAppMessage({
            title: title,
            desc: desc,
            link: link,
            imgUrl: imgUrl,
          });      

          // 2.2 监听“分享到朋友圈”按钮点击、自定义分享内容及分享结果接口
          wx.onMenuShareTimeline({
            title: title,
            desc: desc,
            link: link,
            imgUrl: imgUrl,
          });

          wx.error(function(res){
              // config信息验证失败会执行error函数，如签名过期导致验证失败，具体错误信息可以打开config的debug模式查看，也可以在返回的res参数中查看，对于SPA可以在这里更新签名。
              //alert("errorMSG:"+res);
          });
        })
      })
      
    </script>
  </body>

</html>